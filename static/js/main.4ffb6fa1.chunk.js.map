{"version":3,"sources":["auth/context.js","auth/authentication.js","data/fakeApi.js","protectedPage.js","App.js","index.js"],"names":["AuthContext","createContext","AuthProvider","children","_useState","useState","isLoggedIn","isLoggingIn","token","user","_useState2","Object","slicedToArray","auth","setAuth","react_default","a","createElement","Provider","value","Authentication","_useContext","useContext","loginHandler","_ref","asyncToGenerator","regenerator_default","mark","_callee","userResponse","wrap","_context","prev","next","objectSpread2","console","log","Promise","resolve","setTimeout","name","sent","stop","apply","this","arguments","Fragment","className","onClick","ProtectedPage","logoutTimer","App","setToken","_useState3","_useState4","tokenExpirationDate","setTokenExpirationDate","login","useCallback","expirationTime","expiration","Date","getTime","localStorage","setItem","JSON","stringify","toISOString","logout","removeItem","useEffect","storedData","parse","getItem","remainingTime","clearTimeout","context","rootElement","document","getElementById","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.4ffb6fa1.chunk.js","sourcesContent":["import React, { createContext, useState } from \"react\";\n\nconst AuthContext = createContext(null);\nconst AuthProvider = ( {children} )  => {\n  const [auth, setAuth] = useState({\n    isLoggedIn: false,\n    isLoggingIn: false,\n    token: null,\n    user: null\n  })\n  return (\n    <AuthContext.Provider value={{ auth, setAuth }}>\n      {children}\n    </AuthContext.Provider>\n  )\n};\n\nexport { AuthContext };\nexport default AuthProvider;\n","import React, { useContext } from \"react\";\nimport { AuthContext } from \"./context\";\nimport { fetchUser } from '../data/fakeApi'\n\nexport default function Authentication() {\n  const {auth, setAuth} = useContext(AuthContext);\n\n   const  loginHandler  = async () => {\n    setAuth({\n      ...auth,\n      isLoggingIn: true\n    })\n\n    const userResponse = await fetchUser();\n\n    setAuth({\n      ...auth,\n      user: userResponse.name,\n      token: userResponse.token,\n      isLoggedIn: true,\n      isLoggingIn: false\n    })\n  };\n\n  const logoutHandler = () => {\n    setAuth({\n      ...auth,\n      user: null,\n      token: null,\n      isLoggedIn: false\n    })\n  };\n\n  return (\n    <>\n      {!auth.isLoggedIn && (\n        <button className=\"login\" onClick={loginHandler}>\n          Login\n        </button>\n      )}\n      \n      {auth.isLoggedIn && (\n        <button className=\"logout\" onClick={logoutHandler}>\n          Logout\n        </button>\n      )}\n\n      {auth.isLoggingIn && (\n        <p>\n          Login In...\n        </p>\n      )}\n    </>\n  );\n}\n","export function fetchUser() {\r\n    console.log(\"fetch user...\");\r\n    return new Promise(resolve => {\r\n      setTimeout(() => {\r\n        console.log(\"fetched user\");\r\n        resolve({ \r\n            name: \"Mr. Daiello\", \r\n            token: \"abjd2323jb443jbbb\" \r\n        });\r\n      }, 500);\r\n    });\r\n  }\r\n","import React, { useContext } from \"react\";\nimport { AuthContext } from \"./auth/context\";\n\nexport default function ProtectedPage() {\n  const { auth } = useContext(AuthContext);\n\n  return auth.isLoggedIn && <h2>Bienvenido {auth.user}</h2>;\n}\n","import React, { useState, useEffect, useCallback } from \"react\";\nimport \"./styles.css\";\nimport AuthProvider from \"./auth/context\";\nimport Authentication from \"./auth/authentication\";\nimport ProtectedPage from \"./protectedPage\";\n\nlet logoutTimer;\n\nexport default function App() {\n  const [token, setToken] = useState(false);\n  const [tokenExpirationDate, setTokenExpirationDate] = useState();\n\n  const login = useCallback((token, expirationTime) => {\n    setToken(token);\n    const expiration = expirationTime || new Date(new Date().getTime() + 1000 * 60 * 60);\n    setTokenExpirationDate(expiration);\n    localStorage.setItem(\"userData\", JSON.stringify({\n        token,\n        expirationTime: expiration.toISOString()\n      })\n    );\n  }, []);\n\n  const logout = useCallback(() => {\n    setToken(null);\n    localStorage.removeItem(\"userData\");\n  }, []);\n\n  useEffect(() => {\n    const storedData = JSON.parse(localStorage.getItem(\"userData\"));\n    if (\n      storedData &&\n      storedData.token &&\n      new Date(storedData.expirationTime) > new Date()\n    ) {\n      login(storedData.token, new Date(storedData.expirationTime));\n    }\n  }, [login]);\n\n  useEffect(() => {\n    if (token && tokenExpirationDate) {\n      const remainingTime =\n        tokenExpirationDate.getTime() - new Date().getTime();\n      logoutTimer = setTimeout(logout, remainingTime);\n    } else {\n      clearTimeout(logoutTimer);\n    }\n  }, [token, logout, tokenExpirationDate]);\n\n  return (\n    <AuthProvider>\n      <div className=\"center\">\n        <Authentication />\n        <ProtectedPage />\n      </div>\n    </AuthProvider>\n  );\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport App from \"./App\";\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  rootElement\n);\n"],"sourceRoot":""}